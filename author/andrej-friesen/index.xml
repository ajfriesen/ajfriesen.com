<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Andrej Friesen</title><link>https://www.ajfriesen.com/author/andrej-friesen/</link><atom:link href="https://www.ajfriesen.com/author/andrej-friesen/index.xml" rel="self" type="application/rss+xml"/><description>Andrej Friesen</description><generator>Wowchemy (https://wowchemy.com)</generator><language>en-us</language><copyright>Andrej Friesen</copyright><lastBuildDate>Tue, 10 Nov 2020 21:00:08 +0100</lastBuildDate><image><url>https://www.ajfriesen.com/author/andrej-friesen/avatar_hue7a4615b0dd455b21865ad75d1503716_147422_270x270_fill_q90_lanczos_center.jpg</url><title>Andrej Friesen</title><link>https://www.ajfriesen.com/author/andrej-friesen/</link></image><item><title>Custom ear-buds for headphones</title><link>https://www.ajfriesen.com/post/custom-ears-buds-for-headphones/</link><pubDate>Tue, 10 Nov 2020 21:00:08 +0100</pubDate><guid>https://www.ajfriesen.com/post/custom-ears-buds-for-headphones/</guid><description>&lt;p>A story of buying headphones and custom ear-buds for sports while over thinking every aspect ðŸ§&lt;/p>
&lt;h2 id="some-context">Some context&lt;/h2>
&lt;p>Headphones are a really personal and subjective thing.
Audio in general is but I do not want to go the route of audio or Hi-Fi here.
Just about the headphone itself.&lt;/p>
&lt;p>For whatever reason, I never could use in-ears.
They did always fall out.
Sometimes left, sometimes right.
If they did fit for longer than a minute it was mostly really painful.&lt;/p>
&lt;p>The years went by and I never used in-ears.
Only some over-ears with noise cancelling in the office.&lt;/p>
&lt;p>Did you ever try to run with over-ears?
Do not even think about any sports activity.
It is not possible with over-ears.
Despite the fact that I want to use them in the rain and they should resist sweat as well.
That was not possible with my over-ears at all.&lt;/p>
&lt;h2 id="what-to-buy">What to buy?&lt;/h2>
&lt;p>Okay, then I did a little research and found this not quite in-ears but in ears with wings on them.
I decided on the Bose SoundSport.&lt;/p>
&lt;figure id="figure-bose-soundsport">
&lt;img alt="Bose SoundSport" srcset="
/post/custom-ears-buds-for-headphones/bose-soundsport-wireless_hu617a0331a0c532b08774c015385c25ee_5662024_5013f130c7d3dec7f7e189ac10bbb3b8.jpg 400w,
/post/custom-ears-buds-for-headphones/bose-soundsport-wireless_hu617a0331a0c532b08774c015385c25ee_5662024_898ae26b6c0b76d6457ac0da3b874764.jpg 760w,
/post/custom-ears-buds-for-headphones/bose-soundsport-wireless_hu617a0331a0c532b08774c015385c25ee_5662024_1200x1200_fit_q90_lanczos.jpg 1200w"
src="https://www.ajfriesen.com/post/custom-ears-buds-for-headphones/bose-soundsport-wireless_hu617a0331a0c532b08774c015385c25ee_5662024_5013f130c7d3dec7f7e189ac10bbb3b8.jpg"
width="760"
height="570"
loading="lazy"
data-zoomable />
&lt;figcaption>
Bose SoundSport
&lt;/figcaption>
&lt;/figure>
&lt;ul>
&lt;li>&lt;input checked="" disabled="" type="checkbox"> Water resistance&lt;/li>
&lt;li>&lt;input checked="" disabled="" type="checkbox"> sweat resistance&lt;/li>
&lt;li>&lt;input checked="" disabled="" type="checkbox"> light&lt;/li>
&lt;li>&lt;input checked="" disabled="" type="checkbox"> no pain&lt;/li>
&lt;li>&lt;input checked="" disabled="" type="checkbox"> Good sound (for me)&lt;/li>
&lt;li>&lt;input disabled="" type="checkbox"> Perfect fit (ðŸ˜’)&lt;/li>
&lt;/ul>
&lt;p>I thought &amp;ldquo;one of these silicone buds should work&amp;rdquo;.
Unfortunately not.
Still running and exercise without constantly readjusting those in my ears was not possible.&lt;/p>
&lt;p>Before someone suggests headphones which have these clips.
They did not work either.
The ear is extremly sensitive to pressure when it is on a small spot and it was sill no perfect fit because most of them are in-ears as well.&lt;/p>
&lt;h2 id="the-solution----custom-ear-buds">The solution &amp;ndash; Custom ear-buds&lt;/h2>
&lt;p>Custom ear-buds or sometimes custom ear-sleeves are just what it says.
Custom made for your ear.&lt;/p>
&lt;p>I recommend you to go to your local hearing acoustics.&lt;/p>
&lt;p>I got them locally for just about 80 â‚¬.
This is not cheap but for me, it was worth it.&lt;/p>
&lt;p>Process of getting them locally:&lt;/p>
&lt;ol>
&lt;li>The hearing technician will put some mould in your ears&lt;/li>
&lt;li>This silicone ear imprint will then send out to a contractor which does the 3D printing of your actual ear-buds&lt;/li>
&lt;li>(optional) When the contractor which does not have the headphones dimensions yet, you need to send the headphones in as well (I did not need to do this)&lt;/li>
&lt;li>Wait a few days&lt;/li>
&lt;li>Get them and enjoy!&lt;/li>
&lt;/ol>
&lt;p>When I looked online it was way more expensive.
Around ~ 100 â‚¬-180 â‚¬.&lt;/p>
&lt;p>You can still get them online.
Here is also a site I did found during my research listing some examples: &lt;a href="https://www.scheinhardt.de/in-ear-monitoring/angepasste-kopfhoerer/kopfhoerer-modelle">https://www.scheinhardt.de/in-ear-monitoring/angepasste-kopfhoerer/kopfhoerer-modelle&lt;/a>&lt;/p>
&lt;p>It is a german website but you can just click at the headphones and see the images with custom ear-buds.&lt;/p>
&lt;h3 id="why-could-i-never-use-in-ears">Why could I never use in-ears?&lt;/h3>
&lt;p>What do you see in this picture?&lt;/p>
&lt;figure id="figure-normal-ear-buds-left-vs-custom-ear-buds-right">
&lt;img alt="normal ear-buds (left) vs. custom ear-buds (right)" srcset="
/post/custom-ears-buds-for-headphones/featured%20copy_huc19a7f3a685bbb746aef5fb1e055c676_1286294_930428fa092b930ea3bd85d91d9d5bb5.jpg 400w,
/post/custom-ears-buds-for-headphones/featured%20copy_huc19a7f3a685bbb746aef5fb1e055c676_1286294_b1501183a75b1c9329b6472cd6a417ab.jpg 760w,
/post/custom-ears-buds-for-headphones/featured%20copy_huc19a7f3a685bbb746aef5fb1e055c676_1286294_1200x1200_fit_q90_lanczos.jpg 1200w"
src="https://www.ajfriesen.com/post/custom-ears-buds-for-headphones/featured%20copy_huc19a7f3a685bbb746aef5fb1e055c676_1286294_930428fa092b930ea3bd85d91d9d5bb5.jpg"
width="760"
height="570"
loading="lazy"
data-zoomable />
&lt;figcaption>
normal ear-buds (left) vs. custom ear-buds (right)
&lt;/figcaption>
&lt;/figure>
&lt;p>In this image you can see the &lt;em>normal&lt;/em> direction for in-ears in general with the green line.
The red line is the direction of my ear canal.
It is the complete opposite.
No wonder in-ears never did fit or caused pain.
It is physically impossible for me to use them ðŸ˜€&lt;/p>
&lt;div class="gallery">
&lt;a data-fancybox="gallery-comparison-in-ears-vs-custom-ear-buds" href="https://www.ajfriesen.com/post/custom-ears-buds-for-headphones/comparison-in-ears-vs-custom-ear-buds/IMG_20200522_184350.jpg" >
&lt;img data-src="https://www.ajfriesen.com/post/custom-ears-buds-for-headphones/comparison-in-ears-vs-custom-ear-buds/IMG_20200522_184350_hu9d89fc45d1ad7e4b39916dce2180beae_3400870_0x190_resize_q90_lanczos.jpg" class="lazyload" alt="IMG_20200522_184350.jpg" width="253" height="190">
&lt;/a>
&lt;a data-fancybox="gallery-comparison-in-ears-vs-custom-ear-buds" href="https://www.ajfriesen.com/post/custom-ears-buds-for-headphones/comparison-in-ears-vs-custom-ear-buds/IMG_20200522_184410.jpg" >
&lt;img data-src="https://www.ajfriesen.com/post/custom-ears-buds-for-headphones/comparison-in-ears-vs-custom-ear-buds/IMG_20200522_184410_hu7a968893d16f58b9bf6d2e9c87c2b062_3536044_0x190_resize_q90_lanczos.jpg" class="lazyload" alt="IMG_20200522_184410.jpg" width="253" height="190">
&lt;/a>
&lt;/div>
&lt;p>And here you can see the side by side comparison.
You can click on one of the images and use the arrow keys fast to check the difference.&lt;/p>
&lt;h2 id="considerations-with-custom-ear-buds">Considerations with custom ear-buds&lt;/h2>
&lt;p>As with everything in technology there is alway an up- and downside of things.
Be aware that using custom ear-buds may interfere with your microphone in 2 ways:&lt;/p>
&lt;ol>
&lt;li>It may be that the earbud material itself needs to cover the microphone holes in order to fit to the ear bud itself&lt;/li>
&lt;/ol>
&lt;p>This could just physically block the sound wave to get into the microphone.
Blocking sound will prevent you from using it to call someone.&lt;/p>
&lt;ol start="2">
&lt;li>Changes the outer dimensions of your headphones&lt;/li>
&lt;/ol>
&lt;p>This is a tricky one.
The guy at the local ohrenstore did explain it to me like this:&lt;/p>
&lt;p>The software which is used by your headphones knows the distance between your mouth and the ear.
Therefore, it knows the time when your voice arraives.
This can be used to recognize your voice.
Sound which takes longer may be from your sorounding area, like traffic.&lt;/p>
&lt;p>If you change the outer dimensions due to custom ear-buds this may have an impact when you want to use the headphones for calls.
If I remember correclty the local store did have that experience with a customer who did get custom ear-buds for his Apple AirPods and could not use them for calls any more.&lt;/p>
&lt;p>The more you know! ðŸ¤¯&lt;/p>
&lt;h3 id="the-sound-may-change-as-well">The sound may change as well&lt;/h3>
&lt;p>It could be possible that the sound of your headpones will be different with the custom ear-buds.
It may be due to the material you choose.
For instance, I could choose between a harder and a softer material.
I did go for soft since I wanted the most comfort for sports.&lt;/p>
&lt;p>It is not just the material which will have an impact.
The length and diameter of your ear-buds do change as well.&lt;/p>
&lt;p>I am not saying it will be better or worse.
It will be different and you have to decided if it is better or worse than before.&lt;/p>
&lt;h2 id="the-problems-with-ture-wireless-headphones-and-their-charging-cases">The problems with ture wireless headphones and their charging cases&lt;/h2>
&lt;p>I did try to find a pair of so called true wireless headphones which I can use my custom ear-buds with.&lt;/p>
&lt;p>&lt;strong>The problem: The charging cases&lt;/strong>&lt;/p>
&lt;p>I did not find a single pair where the charging case would be big enough to store the custom ear-buds.&lt;/p>
&lt;p>Since I already got the Bose SoundSport and the Bose SoundSport free wireless where just announced I figured I could try these.&lt;/p>
&lt;p>Here is the result:&lt;/p>
&lt;div class="gallery">
&lt;a data-fancybox="gallery-charging-case" href="https://www.ajfriesen.com/post/custom-ears-buds-for-headphones/charging-case/IMG_20190605_160253.jpg" >
&lt;img data-src="https://www.ajfriesen.com/post/custom-ears-buds-for-headphones/charging-case/IMG_20190605_160253_hueb4ffb99096f6e2737358d784fe21436_1707561_0x190_resize_q90_lanczos.jpg" class="lazyload" alt="IMG_20190605_160253.jpg" width="253" height="190">
&lt;/a>
&lt;a data-fancybox="gallery-charging-case" href="https://www.ajfriesen.com/post/custom-ears-buds-for-headphones/charging-case/IMG_20190605_160259.jpg" data-caption="Bose SoundSPort wireless free open with custom ear-buds (does not fit)">
&lt;img data-src="https://www.ajfriesen.com/post/custom-ears-buds-for-headphones/charging-case/IMG_20190605_160259_hud152f5f6d0373ef08b8bfa35f4244e9a_932808_0x190_resize_q90_lanczos.jpg" class="lazyload" alt="Bose SoundSPort wireless free open with custom ear-buds (does not fit)" width="253" height="190">
&lt;/a>
&lt;a data-fancybox="gallery-charging-case" href="https://www.ajfriesen.com/post/custom-ears-buds-for-headphones/charging-case/IMG_20190605_162411.jpg" >
&lt;img data-src="https://www.ajfriesen.com/post/custom-ears-buds-for-headphones/charging-case/IMG_20190605_162411_hud400a3db18b11b51a00ee248202974eb_1418780_0x190_resize_q90_lanczos.jpg" class="lazyload" alt="IMG_20190605_162411.jpg" width="253" height="190">
&lt;/a>
&lt;a data-fancybox="gallery-charging-case" href="https://www.ajfriesen.com/post/custom-ears-buds-for-headphones/charging-case/IMG_20190605_224114.jpg" >
&lt;img data-src="https://www.ajfriesen.com/post/custom-ears-buds-for-headphones/charging-case/IMG_20190605_224114_hu2fc42862c7d2d767d6fdea5bf123baef_1217414_0x190_resize_q90_lanczos.jpg" class="lazyload" alt="IMG_20190605_224114.jpg" width="253" height="190">
&lt;/a>
&lt;a data-fancybox="gallery-charging-case" href="https://www.ajfriesen.com/post/custom-ears-buds-for-headphones/charging-case/IMG_20190605_224233.jpg" >
&lt;img data-src="https://www.ajfriesen.com/post/custom-ears-buds-for-headphones/charging-case/IMG_20190605_224233_hu3adbd0a23dcb2e6255ad14e3e449b6ed_382843_0x190_resize_q90_lanczos.jpg" class="lazyload" alt="IMG_20190605_224233.jpg" width="253" height="190">
&lt;/a>
&lt;a data-fancybox="gallery-charging-case" href="https://www.ajfriesen.com/post/custom-ears-buds-for-headphones/charging-case/IMG_20190605_224248.jpg" >
&lt;img data-src="https://www.ajfriesen.com/post/custom-ears-buds-for-headphones/charging-case/IMG_20190605_224248_huacaa865d109d469cc5f76b8266032c8e_395775_0x190_resize_q90_lanczos.jpg" class="lazyload" alt="IMG_20190605_224248.jpg" width="253" height="190">
&lt;/a>
&lt;a data-fancybox="gallery-charging-case" href="https://www.ajfriesen.com/post/custom-ears-buds-for-headphones/charging-case/IMG_20190605_224342.jpg" >
&lt;img data-src="https://www.ajfriesen.com/post/custom-ears-buds-for-headphones/charging-case/IMG_20190605_224342_hu8e01b119c16cd2b031f281f9161be26e_444458_0x190_resize_q90_lanczos.jpg" class="lazyload" alt="IMG_20190605_224342.jpg" width="253" height="190">
&lt;/a>
&lt;a data-fancybox="gallery-charging-case" href="https://www.ajfriesen.com/post/custom-ears-buds-for-headphones/charging-case/IMG_20190605_224400.jpg" >
&lt;img data-src="https://www.ajfriesen.com/post/custom-ears-buds-for-headphones/charging-case/IMG_20190605_224400_hu85e59f12bc46a129dcd83fed37d3fa2c_282210_0x190_resize_q90_lanczos.jpg" class="lazyload" alt="IMG_20190605_224400.jpg" width="253" height="190">
&lt;/a>
&lt;a data-fancybox="gallery-charging-case" href="https://www.ajfriesen.com/post/custom-ears-buds-for-headphones/charging-case/IMG_20190605_224411.jpg" >
&lt;img data-src="https://www.ajfriesen.com/post/custom-ears-buds-for-headphones/charging-case/IMG_20190605_224411_hud5365613c90bbeb72a4444697a177192_428730_0x190_resize_q90_lanczos.jpg" class="lazyload" alt="IMG_20190605_224411.jpg" width="253" height="190">
&lt;/a>
&lt;a data-fancybox="gallery-charging-case" href="https://www.ajfriesen.com/post/custom-ears-buds-for-headphones/charging-case/IMG_20190605_224434.jpg" >
&lt;img data-src="https://www.ajfriesen.com/post/custom-ears-buds-for-headphones/charging-case/IMG_20190605_224434_hu6a62a58c0190292f43a559627159c1a5_408604_0x190_resize_q90_lanczos.jpg" class="lazyload" alt="IMG_20190605_224434.jpg" width="253" height="190">
&lt;/a>
&lt;/div>
&lt;p>As you can see there is not enough space for the custom ear-buds in my case (pun intended).
Your milage may vary.&lt;/p>
&lt;p>I was considering to damage the case by using a dremel and cut out some space for the custom ear-buds.
Unfortunately these cases do not have any unused space anywhere.&lt;/p>
&lt;p>I just could have always removed the custom ear-buds to charge my true wireless headphones but this is not an option for several reasons.&lt;/p>
&lt;ol>
&lt;li>Lazyness&lt;/li>
&lt;li>When removing them I need to store them somewhere and might lose them since they are tiny&lt;/li>
&lt;li>The ear-buids will break&lt;/li>
&lt;/ol>
&lt;p>Why would they break you ask?&lt;/p>
&lt;p>Have a look at this:&lt;/p>
&lt;figure id="figure-example-rancher-vpc-setup">
&lt;img alt="Example Rancher VPC Setup" srcset="
/post/custom-ears-buds-for-headphones/ripping-of-material_hufdb47781b5be6dfdaccbbdf60ffa6a80_1868715_33f1cd6633eebdee5033d55b35487fe2.jpg 400w,
/post/custom-ears-buds-for-headphones/ripping-of-material_hufdb47781b5be6dfdaccbbdf60ffa6a80_1868715_62d8639dc4e60d917e7ad3a1c885992e.jpg 760w,
/post/custom-ears-buds-for-headphones/ripping-of-material_hufdb47781b5be6dfdaccbbdf60ffa6a80_1868715_1200x1200_fit_q90_lanczos.jpg 1200w"
src="https://www.ajfriesen.com/post/custom-ears-buds-for-headphones/ripping-of-material_hufdb47781b5be6dfdaccbbdf60ffa6a80_1868715_33f1cd6633eebdee5033d55b35487fe2.jpg"
width="760"
height="570"
loading="lazy"
data-zoomable />
&lt;figcaption>
Example Rancher VPC Setup
&lt;/figcaption>
&lt;/figure>
&lt;p>The two little edges on the headphone hold the ear-buds.
Problem here: The material of that ear-buds is not strong enough to handle this amount of disassamly.
You already can see they are wearing off.&lt;/p>
&lt;p>I am solving this problem by removing and putting them on with the potentially damged side first and strecht the rest of the material to fit over the audio canal.
This way there is no material leaving the custom ear-bud.&lt;/p>
&lt;h2 id="conclusion">Conclusion&lt;/h2>
&lt;p>Nothing is simple when you think like an enigneer and try to find the best solution for your problem.
Everything has upsides and downsides.&lt;/p>
&lt;p>What is your experience with headphones especially for sport?&lt;/p>
&lt;p>&lt;strong>To all the big companys building true wireless headphones:&lt;/strong> Please make true wireless headphones where I can put in my custom ear-buds in the case as well.
Just put some space into the charging case.&lt;/p></description></item><item><title>Netstat shows tcp6 on ipv4 only host</title><link>https://www.ajfriesen.com/post/netstat-shows-tcp6/</link><pubDate>Wed, 20 May 2020 08:30:00 +0200</pubDate><guid>https://www.ajfriesen.com/post/netstat-shows-tcp6/</guid><description>&lt;p>Why netstat shows tcp6 sockets even though you only have ipv4 configured.&lt;/p>
&lt;p>The other day I was building an AWS AMI (Amazon Machine Image) with packer which should run some java software.
The software itself does not matter.&lt;/p>
&lt;p>While testing something I just wanted to check for the ports with netstat.
I got this output and was wondering why the ports where of type tcp6.
This was in AWS within a VPC which did not have ipv6 enabled.&lt;/p>
&lt;pre>&lt;code class="language-bash">[ec2-user@ip-172-17-9-250 ~]$ sudo netstat -natp
tcp6 0 0 :::8080 :::* LISTEN 3861/java
tcp6 0 0 :::8082 :::* LISTEN 3860/java
tcp6 0 0 127.0.0.1:1527 :::* LISTEN 3859/java
tcp6 0 0 :::2181 :::* LISTEN 3858/java
&lt;/code>&lt;/pre>
&lt;p>I was also able to get a curl running against some web interface from anther machine with curl which only had ipv4 enabled as well.
That means die application itself was answering on ipv4.
Also, I know that ipv4 and ipv6 are not campatible at all.
If you wanted ipv4 server to speak with ipv6 and vice versa you need NAT64&lt;sup id="fnref:1">&lt;a href="#fn:1" class="footnote-ref" role="doc-noteref">1&lt;/a>&lt;/sup>, which translates ipv4 and ipv6 traffic.&lt;/p>
&lt;p>I was confused&amp;hellip;&lt;/p>
&lt;p>It turns out the socket itself is an ipv6 socket.
I also did not know that there is a special ipv6 address range which maps to ipv4 addresses.&lt;sup id="fnref:2">&lt;a href="#fn:2" class="footnote-ref" role="doc-noteref">2&lt;/a>&lt;/sup>
That means all ipv4 adresses are also ipv6 adresses.&lt;sup id="fnref:3">&lt;a href="#fn:3" class="footnote-ref" role="doc-noteref">3&lt;/a>&lt;/sup>&lt;/p>
&lt;p>So these sockets work with ipv4 but since they are really ipv6 sockets they are listed as tcp6 in netstat.&lt;/p>
&lt;p>The more you know.&lt;/p>
&lt;section class="footnotes" role="doc-endnotes">
&lt;hr>
&lt;ol>
&lt;li id="fn:1" role="doc-endnote">
&lt;p>&lt;a href="https://en.wikipedia.org/wiki/NAT64" target="_blank" rel="noopener">Wikipedia - NAT64&lt;/a> &lt;a href="#fnref:1" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;li id="fn:2" role="doc-endnote">
&lt;p>&lt;a href="https://en.wikipedia.org/wiki/IPv6#IPv4-mapped_IPv6_addresses" target="_blank" rel="noopener">Wikipedia - IPv4-mapped IPv6 addresses&lt;/a> &lt;a href="#fnref:2" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;li id="fn:3" role="doc-endnote">
&lt;p>&lt;a href="https://unix.stackexchange.com/questions/152612/netstat-why-are-ipv4-daemons-listening-to-ports-listed-only-in-a-inet6" target="_blank" rel="noopener">StackExchange - netstat â€” why are IPv4 daemons listening to ports listed only in -A inet6?&lt;/a> &lt;a href="#fnref:3" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/section></description></item><item><title>Rancher Overview</title><link>https://www.ajfriesen.com/post/rancher-overview/</link><pubDate>Mon, 13 Apr 2020 12:46:44 +0200</pubDate><guid>https://www.ajfriesen.com/post/rancher-overview/</guid><description>&lt;details class="toc-inpage d-print-none " open>
&lt;summary class="font-weight-bold">Table of Contents&lt;/summary>
&lt;nav id="TableOfContents">
&lt;ul>
&lt;li>&lt;a href="#rancher">Rancher&lt;/a>&lt;/li>
&lt;li>&lt;a href="#rke--rancher-kubernetes-engine">rke â€” Rancher Kubernetes Engine&lt;/a>&lt;/li>
&lt;li>&lt;a href="#rancher2">Rancher2&lt;/a>&lt;/li>
&lt;li>&lt;a href="#rancher-management-cluster-and-user-cluster-example">Rancher Management Cluster and User Cluster Example&lt;/a>&lt;/li>
&lt;li>&lt;a href="#rancher-vocabulary">Rancher vocabulary&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#cloud-credentials">Cloud Credentials&lt;/a>&lt;/li>
&lt;li>&lt;a href="#node-templates">Node Templates&lt;/a>&lt;/li>
&lt;li>&lt;a href="#kubernetes-cluster-with-node-pools">Kubernetes Cluster with Node Pools&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#rancher-terraform-provider">Rancher Terraform Provider&lt;/a>&lt;/li>
&lt;li>&lt;a href="#rke-terraform-provider">rke Terraform Provider&lt;/a>&lt;/li>
&lt;li>&lt;a href="#final-words">Final words&lt;/a>&lt;/li>
&lt;/ul>
&lt;/nav>
&lt;/details>
&lt;h2 id="rancher">Rancher&lt;/h2>
&lt;p>Rancher is a Kubernetes distribution build by Rancher Labs.
There are some others like OpenShift from Red Hat with different features.&lt;/p>
&lt;p>The distribution will run Kubernetes opinionated so you do not have to think of every detail.&lt;/p>
&lt;p>Example:&lt;/p>
&lt;p>Kubernetes does not come with a user management system.
You could implement this your own or just pick a distribution which has done all the work for you.
Rancher comes with different authentication providers like GitHub, Azure AD and others.
It is baked in.
Just configure the authentication in Rancher, OpenShift or your Kubernetes distribution of choice and that is it.&lt;/p>
&lt;p>Since it is opinionated, it may not fit your use case.
Maybe you just need to dig a little deeper into the configuration options that depends on your needs.&lt;/p>
&lt;p>Features Rancher will give you:&lt;/p>
&lt;ul>
&lt;li>User management, since Kubernetes does not have user management backed in&lt;/li>
&lt;li>A neat web interface to browse your clusters (yes, I mean several clusters!)&lt;/li>
&lt;li>Provision to major cloud providers (AWS, Google, Azure), bare metal, vmware vSphere etc.&lt;/li>
&lt;li>Kubernetes Cluster backups, upgrades, etc.&lt;/li>
&lt;li>One place to manage a lot&lt;/li>
&lt;/ul>
&lt;p>Listing all features of Rancher does not make sense here.&lt;br>
I just want you to know, that all lot is taken care of and that is the real reason to choose a Kubernetes distribution.
This is basic and important stuff which you would need to implement by yourself.
Pick your flavor and go with it like Linux distributions ðŸ˜‰.&lt;/p>
&lt;h2 id="rke--rancher-kubernetes-engine">rke â€” Rancher Kubernetes Engine&lt;/h2>
&lt;p>Rancher2 is the shiny web interface and API everybody talks about.
rke is the Kubernetes installer which you used to create Kubernetes clusters with when using Rancher.&lt;/p>
&lt;p>It is rke which does the magic in Rancher.
Rancher is packed with a certain version of rke.
If you just want a Kubernetes Cluster to play with you can use several tools like:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://github.com/kubernetes/kops" target="_blank" rel="noopener">kops&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://kubernetes.io/docs/setup/production-environment/tools/kubeadm/install-kubeadm/" target="_blank" rel="noopener">kubeadm&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://github.com/kubicorn/kubicorn" target="_blank" rel="noopener">kubicorn&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://github.com/kubernetes/minikube" target="_blank" rel="noopener">minikube&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://github.com/rancher/rke" target="_blank" rel="noopener">rke (Rancher Kubernetes Engine)&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>rke is just another method to install and maintain your Kubernetes clusters in the Rancher opinionated way.
There are a lot of configuration options.
Check the &lt;a href="https://rancher.com/docs/rke/latest/en/" target="_blank" rel="noopener">rke docs&lt;/a> for more information.&lt;/p>
&lt;p>rke will give you a Kubernetes cluster to work with but not the Rancher web interface!
This is somewhat confusing, when you just start.&lt;/p>
&lt;p>You can always see which Rancher version uses which rke version and therefore the support of the Kubernetes version in the &lt;a href="https://github.com/rancher/rancher/releases/" target="_blank" rel="noopener">rancher/rancher repository&lt;/a>&lt;/p>
&lt;p>&lt;img src="rancher-release.png" alt="Rancher release page">&lt;/p>
&lt;p>Here you can see that &lt;a href="https://github.com/rancher/rancher/releases/tag/v2.2.11" target="_blank" rel="noopener">rancher v2.2.11&lt;/a> uses &lt;a href="https://github.com/rancher/rke/releases/tag/v0.2.10" target="_blank" rel="noopener">rke v0.2.10&lt;/a> and supports up to these Kubernetes version:&lt;/p>
&lt;ul>
&lt;li>1.13.12&lt;/li>
&lt;li>1.14.10&lt;/li>
&lt;li>1.15.11&lt;/li>
&lt;/ul>
&lt;p>A good overview for support and all the versions about Rancher can be found in their docs: &lt;a href="https://rancher.com/support-maintenance-terms/all-supported-versions/rancher-v2.3.2/" target="_blank" rel="noopener">Rancher Support Matrix&lt;/a>&lt;/p>
&lt;h2 id="rancher2">Rancher2&lt;/h2>
&lt;p>Rancher itself is the Rancher API and web interface which you often see on the internet when someone is referring to Rancher.&lt;/p>
&lt;p>Rancher will run on top of your Kubernetes cluster created by rke.
You can deploy Rancher via helm to that first rke cluster you created.&lt;/p>
&lt;p>Here is the &lt;a href="https://github.com/rancher/rancher/tree/master/chart" target="_blank" rel="noopener">Rancher Helm Chart&lt;/a> and the according documentation on the Rancher website &lt;a href="https://rancher.com/docs/rancher/v2.x/en/installation/k8s-install/helm-rancher/" target="_blank" rel="noopener">Install Rancher on the Kubernetes Cluster&lt;/a>&lt;/p>
&lt;p>So now you have a Kubernetes cluster with the Rancher 2 helm chart deployed on to.
This Cluster should not be used as a Cluster for workloads.
Since Rancher comes with rke you can now deploy as many clusters as you like to what location you like.&lt;/p>
&lt;h2 id="rancher-management-cluster-and-user-cluster-example">Rancher Management Cluster and User Cluster Example&lt;/h2>
&lt;p>Rancher/rke will not take care of your general AWS infrastructure like networking.
This needs to be taken care of by yourself.
I would recommend going with Terraform but AWS Cloudformation and the AWS Console will work as well.&lt;/p>
&lt;p>The first thing you need is a network and nodes to install a Kubernetes cluster with rke.
It would look like Figure 1:&lt;/p>
&lt;figure id="figure-example-rancher-vpc-setup">
&lt;img alt="Example Rancher VPC Setup" srcset="
/post/rancher-overview/rancher-vpc-setup_hu46800aa06a60e12b81a9f4eb7111923c_50966_eccaa4a9a1944ce38947e2b66eef435c.png 400w,
/post/rancher-overview/rancher-vpc-setup_hu46800aa06a60e12b81a9f4eb7111923c_50966_ef3b4452931c8d2765579f379c427bd1.png 760w,
/post/rancher-overview/rancher-vpc-setup_hu46800aa06a60e12b81a9f4eb7111923c_50966_1200x1200_fit_lanczos_2.png 1200w"
src="https://www.ajfriesen.com/post/rancher-overview/rancher-vpc-setup_hu46800aa06a60e12b81a9f4eb7111923c_50966_eccaa4a9a1944ce38947e2b66eef435c.png"
width="683"
height="732"
loading="lazy"
data-zoomable />
&lt;figcaption data-pre="Figure&amp;nbsp;" data-post=":&amp;nbsp;" class="numbered">
Example Rancher VPC Setup
&lt;/figcaption>
&lt;/figure>
&lt;p>There is a lot missing like Internet Gateways, NAT Gatways, routing tables, routes and you could use an Application Load Balancer instead the Network Load Balancer.
But you get the idea.&lt;/p>
&lt;p>Next you would need to install Rancher to that Kubernetes cluster which is running on the 3 Rancher nodes.
After some DNS configuration and certificates you have a Rancher 2 web interface and API ready to go.&lt;/p>
&lt;p>Easy right?
Yeah.
I know it is a lot of work.
So letÂ´s go on.&lt;/p>
&lt;p>Now you can use the Rancher2 web interface to create your cluster right?&lt;/p>
&lt;p>&lt;strong>Wrong!&lt;/strong>&lt;/p>
&lt;p>We first need another VPC to deploy the Rancher user cluster into.
It is mostly the same setup as before but you need a VPC Perring (VPC Gateway is also possible) and you do not need to place EC2 nodes into the cluster.
That will be taken care of Rancher.&lt;/p>
&lt;figure id="figure-example-rancher-vpc-setup-with-user-cluster">
&lt;img alt="Example Rancher VPC Setup with User Cluster" srcset="
/post/rancher-overview/rancher-vpc-setup-with-user-cluster_hue005e98fc18280de5d8cdf1cc3b1a37c_83055_1674615f3e4857ea8d6f5cf1e9bd3fb8.png 400w,
/post/rancher-overview/rancher-vpc-setup-with-user-cluster_hue005e98fc18280de5d8cdf1cc3b1a37c_83055_0b16d09e908503bd4fa4d692b0b65d3c.png 760w,
/post/rancher-overview/rancher-vpc-setup-with-user-cluster_hue005e98fc18280de5d8cdf1cc3b1a37c_83055_1200x1200_fit_lanczos_2.png 1200w"
src="https://www.ajfriesen.com/post/rancher-overview/rancher-vpc-setup-with-user-cluster_hue005e98fc18280de5d8cdf1cc3b1a37c_83055_1674615f3e4857ea8d6f5cf1e9bd3fb8.png"
width="760"
height="408"
loading="lazy"
data-zoomable />
&lt;figcaption data-pre="Figure&amp;nbsp;" data-post=":&amp;nbsp;" class="numbered">
Example Rancher VPC Setup with User Cluster
&lt;/figcaption>
&lt;/figure>
&lt;p>Why do you need the peering?
Rancher will ssh into each node and will do the provisioning for each Kubernetes node.
Also the created Kubernetes cluster will ping back to Rancher for health checks.&lt;/p>
&lt;h2 id="rancher-vocabulary">Rancher vocabulary&lt;/h2>
&lt;p>To create the actual user cluster you need to know how Rancher will create those.
For that I will explain briefly what Rancher resources you need for the user cluster:&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Word&lt;/th>
&lt;th>Description&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>&lt;code>rke&lt;/code>&lt;/td>
&lt;td>rancher kubernetes engine. A Kubernetes installer in the Rancher way.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>Rancher&lt;/code>&lt;/td>
&lt;td>Rancher API and web interface.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>Cloud Credentials&lt;/code>&lt;/td>
&lt;td>Credentials to your provider (AWS, Google, Azure, etc.).&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>Node Templates&lt;/code>&lt;/td>
&lt;td>Definition of Node. Networking, Instance Type, Image, etc.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>Node Pool&lt;/code>&lt;/td>
&lt;td>Mapping between Node Role and Node Template when creating a User Cluster.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>Node Role&lt;/code>&lt;/td>
&lt;td>Worker, etcd and Control Plane roles for Kubernetes&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>User Cluster&lt;/code>&lt;/td>
&lt;td>The Cluster created for your actual workload&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;hr>
&lt;h3 id="cloud-credentials">Cloud Credentials&lt;/h3>
&lt;p>Cloud Credentials is just an AWS Access Key and Access Secret.&lt;br>
&lt;strong>Do not use your user bound AWS credentials!&lt;/strong>&lt;/p>
&lt;p>What will happen, when you deploy your Kubernetes Cluster with the credentials from a user and they leave the company?&lt;/p>
&lt;ol>
&lt;li>You will deactivate the AWS account because of off boarding&lt;/li>
&lt;li>Suddenly the cluster does not have proper credentials to interact with the AWS API anymore&lt;/li>
&lt;li>Finding out will take you some time and can have bad effects like nodes not coming up in AWS&lt;/li>
&lt;/ol>
&lt;p>Why do I know that?
It is called experience ;-)&lt;/p>
&lt;h3 id="node-templates">Node Templates&lt;/h3>
&lt;p>Node Templates are just what it says.
You define values like:&lt;/p>
&lt;ul>
&lt;li>VPC&lt;/li>
&lt;li>subnet&lt;/li>
&lt;li>EC2 instance type&lt;/li>
&lt;li>AMI&lt;/li>
&lt;li>ssh user&lt;/li>
&lt;li>etc.&lt;/li>
&lt;/ul>
&lt;p>As you can see you need a Node Template for every availability zone since subnet in an AWS VPC are bound to an availability zone.&lt;/p>
&lt;p>You also can use different EC2 instance types for Kubernetes Worker, etcd and control plane.&lt;/p>
&lt;p>If you are testing out the provisioning and you encounter errors, check that the instance itself is not too small.
I did run into it myself and could not figure out what was wrong.
Increasing the EC2 instance type to a more performant machine did resolve that issue.&lt;/p>
&lt;h3 id="kubernetes-cluster-with-node-pools">Kubernetes Cluster with Node Pools&lt;/h3>
&lt;p>A Kubernetes cluster in Rancher is made of Node Pools.
The Node Pool is just a mapping between the Node Templates and the role in the cluster.&lt;/p>
&lt;p>The role can be one of the following:&lt;/p>
&lt;ul>
&lt;li>Worker (will run you workload)&lt;/li>
&lt;li>etcd (Database for Kubernetes)&lt;/li>
&lt;li>control Plane (Kubernetes API)&lt;/li>
&lt;/ul>
&lt;p>Then you can configure the cluster itself with the right Cloud Provider.
This will allow you to use the &lt;code>serviceType LoadBalancer&lt;/code> and AWS or other vendors will spawn a Load Balancer for your particular service.&lt;/p>
&lt;p>Also you can configure your network driver, snapshots and much more.&lt;/p>
&lt;h2 id="rancher-terraform-provider">Rancher Terraform Provider&lt;/h2>
&lt;p>Rancher Labs is also providing an official Rancher2 Terraform Provider.
You can create most resources specific to Rancher with that provider.
Now you can automate everything with Terraform.
From creating the network in AWS up to the cluster in Rancher.&lt;/p>
&lt;p>Rancher2 Terraform Provider on the Terraform Website:&lt;br>
&lt;a href="https://www.terraform.io/docs/providers/rancher2/index.html" target="_blank" rel="noopener">https://www.terraform.io/docs/providers/rancher2/index.html&lt;/a>&lt;/p>
&lt;p>Rancher2 Terraform Provider source at GitHub :&lt;br>
&lt;a href="https://github.com/terraform-providers/terraform-provider-rancher2" target="_blank" rel="noopener">https://github.com/terraform-providers/terraform-provider-rancher2&lt;/a>&lt;/p>
&lt;h2 id="rke-terraform-provider">rke Terraform Provider&lt;/h2>
&lt;p>There was a Terraform provider made by &lt;a href="https://github.com/yamamoto-febc" target="_blank" rel="noopener">Kazumichi Yamamoto&lt;/a> which I have used in version v0.14.1 to automate the creation of the Rancher management cluster.
But I think Rancher has taken over the development of that project and the repository moved to the rancher organization.&lt;/p>
&lt;p>&lt;a href="https://github.com/rancher/terraform-provider-rke" target="_blank" rel="noopener">https://github.com/rancher/terraform-provider-rke&lt;/a>&lt;/p>
&lt;p>Rancher Labs is pretty fast in developing these tools.
It will take some time and then the Terraform rke provider will move to the official Terraform providers organization.&lt;/p>
&lt;p>Until then, you have to download the provider by yourself at &lt;a href="https://github.com/rancher/terraform-provider-rke" target="_blank" rel="noopener">rancher-terraform-provider-rke&lt;/a>.
Only official HashiCorp providers listed &lt;a href="https://www.terraform.io/docs/providers/index.html" target="_blank" rel="noopener">here&lt;/a> in the &lt;a href="https://github.com/terraform-providers" target="_blank" rel="noopener">terraform-providers GitHub organization&lt;/a> will be downloaded for you when running &lt;code>terraform init&lt;/code>.&lt;/p>
&lt;h2 id="final-words">Final words&lt;/h2>
&lt;p>Kubernetes itself already is a lot to learn.
Put Rancher specific terms to that pile you have even more material to go through.
We only did scratch the surface.
For this to build you anyway need to learn AWS basics, Kubernetes basics and Rancher basics.&lt;/p>
&lt;p>I hope that helped to understand Rancher running on AWS a little bit better.&lt;/p></description></item><item><title>Decrypt and mount LUKS volume in GRUB rescue mode</title><link>https://www.ajfriesen.com/post/decrypt-and-mount-luks-volume-in-grub-rescue-mode/</link><pubDate>Mon, 13 Apr 2020 01:26:15 +0200</pubDate><guid>https://www.ajfriesen.com/post/decrypt-and-mount-luks-volume-in-grub-rescue-mode/</guid><description>&lt;p>I am running arch Linux on my server with LUKS disc encryption.
I do need to type in my password every time I reboot the machine.
Sometimes I have a typo and this happens:&lt;/p>
&lt;pre>&lt;code>Welcome to GRUB!
Attempting to decrypt master key...
Enter passphrase for hd1,gpt2 (&amp;lt;disk uuid&amp;gt;):
error: access denied
error: no such cryptodisk found.
error: disk `cryptouuid/&amp;lt;disk uuid&amp;gt;` not found.
Entering rescue mode...
&lt;/code>&lt;/pre>
&lt;p>Since with IPMI I do not need to attach a VGA cable and keyboard to my server but still the grub rescue console is something I am not familiar with and need to deal with.&lt;/p>
&lt;p>You can mount the partition with &lt;code>cryptomount&lt;/code>:&lt;sup id="fnref:1">&lt;a href="#fn:1" class="footnote-ref" role="doc-noteref">1&lt;/a>&lt;/sup>&lt;/p>
&lt;pre>&lt;code>cryptomount (hd1,gpt2)
&lt;/code>&lt;/pre>
&lt;p>Enter your password.&lt;/p>
&lt;p>Then load the module for a normal boot&lt;/p>
&lt;pre>&lt;code>insmod normal
&lt;/code>&lt;/pre>
&lt;p>Boot:&lt;/p>
&lt;pre>&lt;code>normal
&lt;/code>&lt;/pre>
&lt;p>Now you should get forwarded to the grub boot manager as you typed the password correct the first time.&lt;/p>
&lt;section class="footnotes" role="doc-endnotes">
&lt;hr>
&lt;ol>
&lt;li id="fn:1" role="doc-endnote">
&lt;p>&lt;a href="https://www.gnu.org/software/grub/manual/grub/html_node/cryptomount.html#cryptomount" target="_blank" rel="noopener">cryptomount&lt;/a> &lt;a href="#fnref:1" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/section></description></item></channel></rss>